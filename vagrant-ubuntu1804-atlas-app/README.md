Vagrantfile for Ubuntu 17 app server
====================================

## Initial start

* prepare `Vagrantfile`

```
$ vi Vagrantfile
```
```ruby
config.dns.tld = "dev"

config.vm.hostname = "machine"

config.dns.patterns = [/^.*mysite.dev$/, /^.*myothersite.dev$/]

config.vm.network :private_network, ip: "33.33.33.60"
```

* prepare vagrant-dns => `vagrant up`

```
$ vagrant plugin install vagrant-dns
$ vagrant dns --install  # 要 Macの管理者パスワード
$ vagrant dns --start

$ vagrant up
```

## stop

```
$ vagrant halt
$ vagrant dns --stop
```

## (vagrant dns)
[BerlinVagrant/vagrant-dns](https://github.com/BerlinVagrant/vagrant-dns)


```
# /etc/resolver 配下に config.vm.tld で指定したtldと同名のファイルが作成される
$ vagrant dns --install


$ view /etc/resolver/localdomain

# this file is generated by vagrant-dns
nameserver 127.0.0.1
port 5300
```
```
# vagrant dns --start を実行後、scutil --dns すると指定したdnsがport=5300で稼働している事が確認できる

$ scutil --dns

resolver #8
  domain   : localdomain
  nameserver[0] : 127.0.0.1
  port     : 5300
  flags    : Request A records, Request AAAA records
  reach    : Reachable,Local Address
```
```
# さらに dscacheutil -q host -a name <Vagrantfileで指定したpattern> を実行すると名前解決出来ている事が確認できる

$ dscacheutil -q host -a name ngircd.localdomain
name: ngircd.localdomain
ip_address: 192.168.56.121
```


